import{j as e,$ as k,D as h,v as j,E as I,_ as l,G as D,H as S,r as p,J as E,A as b,K as q,d as P,u as T,l as F,Q,B as f}from"./index-CNfmmmxb.js";function Y({decrease:s,increase:t,quantiny:a,status:n}){return e.jsxs("div",{className:"border-2 flex columns-3  justify-between rounded-md font-semibold",children:[e.jsx("button",{className:"px-2",onClick:s,children:"-"}),e.jsxs("p",{className:"px-4 py-0.5 border-s text-sm font-lato",children:[n==="pending"?e.jsx("i",{className:"inline-block ",children:e.jsx(k,{visible:!0,color:"#black",width:"8",height:"full",radius:"9",ariaLabel:"three-dots-loading",wrapperClass:"text-sm"})}):a,"  "]}),e.jsx("button",{className:"px-3 bg-green-600 rounded-e-md text-white",onClick:t,children:"+"})]})}function B(){const s=h(),{mutate:t,status:a}=j({mutationFn:({id:n,quantiny:r})=>I(n,r),onSuccess:()=>{s.invalidateQueries({queryKey:["cart"]}),l.success("count Increased successfully ")},onError:n=>{l.error("cannot update count")}});return{mutateCount:t,status:a}}function z(s){return D({tag:"svg",attr:{version:"1.2",baseProfile:"tiny",viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M12 3c-4.963 0-9 4.038-9 9s4.037 9 9 9 9-4.038 9-9-4.037-9-9-9zm0 16c-3.859 0-7-3.14-7-7s3.141-7 7-7 7 3.14 7 7-3.141 7-7 7zM12.707 12l2.646-2.646c.194-.194.194-.512 0-.707-.195-.194-.513-.194-.707 0l-2.646 2.646-2.646-2.647c-.195-.194-.513-.194-.707 0-.195.195-.195.513 0 .707l2.646 2.647-2.646 2.646c-.195.195-.195.513 0 .707.097.098.225.147.353.147s.256-.049.354-.146l2.646-2.647 2.646 2.646c.098.098.226.147.354.147s.256-.049.354-.146c.194-.194.194-.512 0-.707l-2.647-2.647z"},child:[]}]})(s)}function K(){const s=h(),t=localStorage.getItem("accessToken"),{mutate:a,status:n}=j({mutationFn:r=>S(r,t),onSuccess:()=>{s.invalidateQueries({queryKey:["cart"]}),l.success("Cart Item Deleted successfully ")},onError:r=>{l.error("Error while Deleting")}});return{deleteItem:a,status:n}}function g({handleDeletion:s,setConfirmShow:t,id:a}){return e.jsx("div",{className:"fixed inset-0 bg-black backdrop-blur-sm  bg-opacity-30 grid place-items-center z-50",children:e.jsxs("div",{className:"bg-gray-100 p-10 blur-none rounded-lg shadow-md   ",children:[e.jsx("h2",{className:" mb-6",children:"Are You sure You Want to delete this item ? "}),e.jsxs("div",{className:"flex columns-2 gap-4",children:[e.jsx("button",{onClick:s,className:"w-1/2 rounded-md bg-green-500 text-white",children:"Yes"}),e.jsx("button",{onClick:()=>t(n=>!n),className:"w-1/2 rounded-md bg-red-800 text-white",children:"No"})]})]})})}function $({product:s}){const{count:t,price:a,product:{brand:{name:n},category:{name:r},id:i,imageCover:d,title:u}}=s,[m,o]=p.useState(!1),{mutateCount:c,status:y}=B(),{deleteItem:C}=K();function N(){c({id:i,quantiny:t-1})}function w(){c({id:i,quantiny:t+1})}function v(){C(i),o(x=>!x)}return e.jsxs(e.Fragment,{children:[m&&e.jsx(g,{handleDeletion:()=>v(),setConfirmShow:o}),e.jsxs("tr",{className:"border border-b relative ",children:[e.jsxs("td",{className:"flex ps-4 py-3 items-center ",children:[e.jsx("img",{src:d,alt:"",className:"w-24 h-24 rounded-2xl shadow-sm object-cover"}),e.jsxs("div",{className:"px-6",children:[e.jsx("p",{className:"text-red-700",children:E(u)}),e.jsxs("p",{className:"text-sm",children:[" ",r]}),e.jsx("p",{className:"text-sm",children:n})]})]}),e.jsx("td",{className:"text-center w-2/12 font-bold  ",children:b(a)}),e.jsx("td",{className:"text-center w-1/12",children:e.jsx(Y,{quantiny:t,status:y,increase:w,decrease:N})}),e.jsx("td",{className:"text-center w-2/12 font-bold  ",children:b(a*t)}),e.jsx("td",{className:"w-0 hid",children:e.jsx("button",{onClick:()=>o(x=>!x),className:"absolute right-3 top-3   text-red-600",children:e.jsx("i",{children:e.jsx(z,{})})})})]})]})}function L(){const s=localStorage.getItem("accessToken"),t=h(),{mutate:a,status:n}=j({mutationFn:()=>q(s),onSuccess:()=>{t.invalidateQueries({queryKey:["cart"]}),l.success("Cart Item Deleted successfully ")},onError:r=>{l.error("Error while Deleting")}});return{clearCartItems:a,status:n}}function _(){const[s,t]=p.useState(!1),a=P(),{cart:{numOfCartItems:n,data:{products:r}={}}={},isLoading:i,isError:d}=T(),{clearCartItems:u}=L();function m(){a("/order/payment")}function o(){u(),t(c=>!c)}return e.jsx(e.Fragment,{children:i?e.jsx(F,{}):d?e.jsx("div",{className:"container py-6 text-2xl",children:"You have no cart yet"}):e.jsxs("div",{className:"py-6 relative container",children:[s&&e.jsx(g,{handleDeletion:()=>o(),setConfirmShow:t}),n?e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-head",children:"Shopping Bag"}),e.jsxs("p",{className:"mb-2",children:[e.jsxs("span",{className:"font-bold text-title",children:[n," items"]}),"  In Your Cart"]})]}),e.jsxs("div",{className:"flex  xs:flex-col lg:flex-row justify-between items-start gap-6",children:[e.jsx("div",{className:"xs:w-full lg:w-9/12 border  shadow-md bg-white rounded-lg",children:e.jsxs("table",{children:[e.jsx("thead",{className:"border-b",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-4  ",children:"Product"}),e.jsx("th",{children:"Price"}),e.jsx("th",{children:"Quantity"}),e.jsx("th",{children:"Total Price"})]})}),e.jsx("tbody",{children:r&&r.map(c=>e.jsx($,{product:c},c._id))})]})}),e.jsxs(Q,{children:[e.jsx(f,{onclick:m,styles:"py-1.5 w-full mt-4 mb-1 font-bold bg-sky text-white ",textContent:"Proced to Checkout"}),e.jsx(f,{onclick:()=>t(c=>!c),styles:"py-1.5 w-full mt-0  bg-red-700 text-white ",textContent:"Clear Cart"})]})]})]}):e.jsx("p",{className:"container py-6 text-xl",children:"Your Cart Item is Empty"})]})})}export{_ as default};
